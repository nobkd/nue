
<script>
  import { router } from '/@nue/app-router.js'
  import { model } from '../model/index.js'
</script>

<div @name="content-panel">
  <header>
    <h2>All contacts</h2>

    <nav>
      <small>{ status() }</small>

      <button class="ghost" @click="seek(-1)" data-accesskey="ArrowLeft h"
        :disabled="!coll?.start" title="Previous page"><icon key="chevron-left"/></button>

      <button class="ghost" @click="seek(1)" data-accesskey="ArrowRight l"
        :disabled="coll?.start + coll?.length >= coll?.total" title="Next page">
        <icon key="chevron-right"/></button>

      <hr>

      <button class="ghost" @click="toggleGridView" data-accesskey="g"
        :aria-pressed="!router.state.show_grid_view"
        title="Toggle table view"><icon key="list"/></button>

      <button class="ghost" @click="toggleGridView" data-accesskey="g"
        :aria-pressed="router.state.show_grid_view"
        title="Toggle grid view"><icon key="grid"/></button>

      <hr>

      <button class="ghost" popovertarget="help" data-accesskey="?"
        title="Show keyboard shortcuts"><icon key="question"/></button>
    </nav>

  </header>

  <section id="main_wrap"/>

  <script>
    router = router

    toggleGridView() {
      router.toggle('show_grid_view')
    }

    mounted() {
      router.bind('type query filter start sort asc', args => {
        const data = this.coll = model.filter(args)
        this.mountChild('user-list', window.main_wrap, data)
        this.update()
      })
    }

    seek(to) {
      const { start, length } = this.coll
      router.set({ start: start + to*length })
    }

    status() {
      const { start, length, total } = this.coll || {}
      return `${ start + 1 } â€“ ${ start + length } of ${ total }`
    }
  </script>
</div>


